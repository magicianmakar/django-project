{% extends "base.html" %}

{% load static %}
{% load perms_helper %}
{% load compress %}
{% load cache %}

{% block main-container %}

    <div class="ibox float-e-margins">
        <div class="ibox-title">
            <h5>Shopify Stores<small></small></h5>
            <div class="ibox-tools">
                {% if not user.is_subuser and stores.count > 1 %}
                <a href="#" class="change-store-orders">
                    <i class="fa fa-sort"></i> Change Order
                </a>
                {% endif %}
            </div>
        </div>
        <div class="ibox-content">
            <div class="row">
                <div class="col-md-12">
            <table class="table table-ligthborder store-tables">
              <thead>
                <tr>
                  <th style="">Name</th>
                  <th class="hidden-xs" style="width:13%">Products</th>
                  <th class="hidden-xs" style="width:13%">Orders</th>

                  {% if not user.is_subuser %}
                  <th class="hidden-sm hidden-xs"></th>
                  {% endif %}
                </tr>
              </thead>
              <tbody id="stores-table-body">
                    {% for item in stores %}
                    <tr class="store-item" store-id="{{item.id}}">
                        <td class="drag-show">
                            <i class="fa fa-bars order-handle" style="color:#ccc;font-size:12px;margin-right:5px;cursor:move;display:none"></i>
                            <a href="{% url 'product' %}?store={{item.id}}">{{item.title}}</a>
                        </td>
                      <td class="hidden-xs" style="white-space:nowrap">
                        {% with connected=item.connected_count saved=item.saved_count %}
                            {% if connected or saved %}
                                {% if saved %}
                                    <a href="/product?store=n&in={{item.id}}" class="label "><span class="num">{{saved}}</span> Saved</a>
                                {% endif %}

                                {% if connected %}
                                    <a href="/product?store={{item.id}}" class="label "><span class="num">{{connected}}</span> Connected</a>
                                {% endif %}
                            {% endif %}
                        {% endwith %}
                      </td>
                      <td class="hidden-xs" style="white-space:nowrap">
                        {% cache 600 orders_status item.id %}
                        {% with pending=item.pending_orders awaiting_tracking=item.awaiting_tracking %}
                            {% if pending or awaiting_tracking %}
                                {% if pending %}
                                <a class="label "
                                href="/orders?store={{item.id}}&status=open&fulfillment=unshipped%2Cpartial&financial=paid&awaiting_order=true&connected=true{% if not item.is_sync_enabled %}&new=1{% endif %}"
                                ><span class="num">{{pending}}</span> Pending</a>
                                {% endif %}

                                {% if awaiting_tracking %}
                                    <a class="label "
                                    href="/orders/track?store={{item.id}}&tracking=0&hidden=0&completed=1"
                                    ><span class="num">{{awaiting_tracking}}</span> Awaiting Tracking</a>
                                {% endif %}
                            {% endif %}
                        {% endwith %}
                        {% endcache %}
                      </td>
                      {% if not user.is_subuser %}
                      <td style="white-space:nowrap" class="hidden-sm hidden-xs">
                        <div class="btn-group ">
                            <button data-toggle="dropdown" class="btn btn-default btn-outline btn-xs dropdown-toggle" aria-expanded="false">
                                <i class="fa fa-cog"></i> <span class=""></span></button>
                            <ul class="dropdown-menu">

                        <li>
                            <a class="visit-store " href="{{item.get_link}}/admin" target="_blank">
                                <i class="fa fa-external-link"></i> Visit Store
                            </a>
                        </li>

                        <li class="divider"></li>

                        <li>
                            <a store-id="{{item.id}}" class="verify-api-url btn-success btn-outline"
                               data-loading-text="<i class='fa fa-circle-o-notch fa-spin'></i> Verifying">
                                <i class="fa fa-check-circle-o"></i> Verify
                            </a>
                        </li>

                        <li>
                            <a store-id="{{item.id}}" class="change-tracking-url btn-success btn-outline">
                                <i class="fa fa-chain"></i> Custom Tracking URL
                            </a>
                        </li>

                        {% if item.version == 1 %}
                        <li>
                            <a class="edit-store  " store-id="{{item.id}}"
                                    store-name="{{item.title}}" store-version="{{item.version}}"
                                    store-url="{% if item.version == 1 %}{{item.get_api_url}}{% endif %}">
                                <i class="fa fa-edit"></i> Edit
                            </a>
                        </li>
                        {% endif %}

                        <li>
                            <a class="delete-store btn-danger btn-outline" store-id="{{item.id}}" store-version="{{item.version}}">
                                <i class="fa fa-times"></i> Delete
                            </a>
                        </li>
                        </ul>
                        </div>
                      </td>
                      {% endif %}
                    </tr>
                    {% empty %}
                    <tr>
                      <td colspan="4" class="text-center">No store found.</td>
                    </tr>
                    {% endfor %}
              </tbody>
            </table>

        {% if not user.is_subuser %}
            <a class="add-store-btn btn btn-primary btn-sm" href="#" data-extra="{{extra_stores|lower}}" data-plan="{{user.profile.plan.title}}">
                Add Store</a>

            Need a new Shopify store?  <a href="http://bit.ly/sashopifyspecial" class="itooltip" title="" data-toggle="tooltip" data-placement="bottom" data-original-title="21 day free trial with 10% off Shopify for Life">Get your Free Trial here</a>
        {% endif %}

            <a href="https://chrome.google.com/webstore/detail/shopified-app/aogkkekoinpipjlolpcicigndjlcpdcn"
               class="btn btn-default btn-outline btn-xs pull-right extension-link hidden-sm hidden-xs" target="_blank">Install Chrome Extension</a>

                </div>
            </div>

        </div>
    </div>
    {% if user|can:'edit_settings.sub' %}
    <div class="ibox float-e-margins">
        <div class="ibox-title">
            <h5>Settings<small></small></h5>
            <div class="ibox-tools">
                <a class="collapse-link"><i class="fa fa-chevron-up"></i></a>
            </div>
        </div>
        <div class="ibox-content">
            <div class="row">
                <div class="col-md-12">
                    <form id="config-form" class="form-horizontal" role="form">
                        <input type="hidden" name="from" value="webapp">
                        <div class="setting-section">
                            <h3 class="setting-title">Products Import</h3>
                        </div>

                        {% if user|can:'auto_margin.use' %}
                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-5">
                                <div class="form-group">
                                    <label for="auto_margin" class="col-sm-4 control-label">
                                        Price Markup
                                        {% include 'partial/help_tooltip.html' with help="For example: If you set Price Markup to <b>50%</b>, a product that costs $10.00 will be set to $15.00" qtipstyle="color:#BBB" %}
                                    </label>
                                    <div class="col-sm-3">
                                        <input style="padding:5px 2px;text-align:center" type="text"
                                               class="form-control col-sm-2" id="auto_margin" name="auto_margin"
                                               value="{% if config.auto_margin != '%' %}{{config.auto_margin}}{% endif %}">
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="auto_margin_cents" class="col-sm-4 control-label">
                                        Price Cents Value
                                       {% include 'partial/help_tooltip.html' with help="For example: If you set Price Cents Value to <b>95</b>, product price will end always by .95" qtipstyle="color:#BBB" %}
                                    </label>
                                    <div class="col-sm-3">
                                        <input style="padding:5px 2px;text-align:center" type="text"
                                               class="form-control col-sm-2" id="auto_margin_cents" name="auto_margin_cents"
                                               value="{{config.auto_margin_cents}}">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-5">
                                <div class="form-group">
                                    <label for="auto_compare_at" class="col-sm-4 control-label" style="padding-top:0">
                                        Compare At Price Markup
                                        {% include 'partial/help_tooltip.html' with help="For example: If set to <b>50%</b>, a product that costs <i>(after Auto Margin)</i> $10.00 will be compared to $15.00" qtipstyle="color:#BBB" %}
                                    </label>
                                    <div class="col-sm-3">
                                        <input style="padding:5px 2px;text-align:center" type="text"
                                               class="form-control col-sm-2" id="auto_compare_at" name="auto_compare_at"
                                               value="{% if config.auto_compare_at != '%' %}{{config.auto_compare_at}}{% endif %}">
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="auto_compare_at_cents" class="col-sm-4 control-label" style="padding-top:0">
                                            Compare At Price Cents Value
                                        {% include 'partial/help_tooltip.html' with help="For example: If you set Compare At Price Cents Value to <b>95</b>, product compare price will end always by .95" qtipstyle="color:#BBB" %}
                                    </label>
                                    <div class="col-sm-3">
                                        <input style="padding:5px 2px;text-align:center" type="text" class="form-control col-sm-2" id="auto_compare_at_cents" name="auto_compare_at_cents" value="{{config.auto_compare_at_cents}}">
                                    </div>
                                </div>
                            </div>
                        </div>

                        {% endif %}

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-5">
                                <div class="form-group">
                                    <label for="default_weight_unit" class="col-sm-4 control-label" style="padding-top:0">
                                        Default Weight Unit
                                    </label>
                                    <div class="col-sm-3">
                                        <select id="default_weight_unit" name="default_weight_unit" class="form-control">
                                            <option value="g" {% if config.default_weight_unit == 'g' %}selected="selected"{% endif %}>g</option>
                                            <option value="kg" {% if config.default_weight_unit == 'kg' %}selected="selected"{% endif %}>kg</option>
                                            <option value="oz" {% if config.default_weight_unit == 'oz' %}selected="selected"{% endif %}>oz</option>
                                            <option value="lb" {% if config.default_weight_unit == 'lb' %}selected="selected"{% endif %}>lb</option>
                                        </select>
                                    </div>
                                    <span class="help-block "></span>
                                </div>
                            </div>
                            <div class="col-sm-6">
                                <div class="form-group">
                                    <label for="default_weight_number" class="col-sm-4 control-label">Fixed Weight</label>
                                    <div class="col-sm-3">
                                        <input type="text" class="form-control text-center col-sm-2" id="default_weight_number" name="default_weight_number" value="{{config.default_weight_number}}">
                                    </div>
                                    <span class="help-block "></span>
                                </div>
                            </div>
                        </div>

                        <div class="col-sm-offset-1"><hr /></div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="description_mode" class="col-sm-2 control-label" style="padding-top:0">
                                        Default Product Description
                                        {% include 'partial/help_tooltip.html' with help="<p><b>Empty</b>: No description will be used.</p><p><b>Original</b>: The full AliExpress product description will be pre-populated.</p><p><b>Simplified</b>: The product specs portion of the AliExpress description will be pre-populated.</p><p><b>Custom</b>: The custom description entered below will be pre-populated.</p>" qtipstyle="color:#BBB" %}
                                    </label>
                                    <div class="col-sm-3">
                                        <select id="description_mode" name="description_mode" class="form-control">
                                            <option value="empty" {% if config.description_mode == 'empty' %}selected="selected"{% endif %}>Empty</option>
                                            <option value="original" {% if config.description_mode == 'original' %}selected="selected"{% endif %}>Original</option>
                                            <option value="simplified" {% if config.description_mode == 'simplified' %}selected="selected"{% endif %}>Simplified</option>
                                            <option value="custom" {% if config.description_mode == 'custom' %}selected="selected"{% endif %}>Custom</option>
                                        </select>
                                    </div>
                                </div>
                                <div id="desc-div" class="form-group" {% if config.description_mode != 'custom' %} style="display:none" {% endif %}>
                                    <label for="default_desc" class="col-sm-2 control-label">Default Description</label>
                                    <div class="col-sm-10">
                                        <textarea name="default_desc" id="default_desc" cols="30" rows="10" class="form-control">{{config.default_desc}}</textarea>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="make_visisble" class="col-sm-4 col-xs-8 control-label">
                                        Make Products Visible
                                    </label>
                                    <div class="col-sm-6 col-xs-4">
                                        <input type="checkbox" class="js-switch" id="make_visisble"
                                               name="make_visisble"{% if config.make_visisble %}checked="checked"{% endif %}>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="make_visisble" class="col-sm-4 col-xs-8 control-label">
                                        <a class="edit-custom-templates-btn" href="#">Custom Product Descriptions...</a>
                                    </label>
                                    <div class="col-sm-6 col-xs-4">
                                    </div>
                                </div>
                            </div>
                        </div>

                        {% if user|can:'auto_order.view' %}
                        {% with can_use=user|can:'auto_order.use' %}
                        <div class="setting-section">
                            <h3 class="setting-title">Auto Fulfill</h3>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <label for="order_phone_number" class="col-sm-2 control-label" style="padding-top:0;padding-left:0;padding-right:25px;">
                                    Order Phone Number
                                    {% include 'partial/help_tooltip.html' with help="The phone number to be used with Auto Order from Aliexpress" qtipstyle="color:#BBB" %}
                                </label>
                                <div class="col-sm-3">
                                    <input type="text" class="form-control col-sm-2" {% if can_use %}id="order_phone_number" name="order_phone_number" value="{{config.order_phone_number}}"{% endif %}>
                                </div>
                                <div id="phone-invalid" class="pull-left col-sm-offset-2 col-sm-6 has-error" style="clear:left;padding-bottom:15px;display:none">
                                    <span class="help-block m-b-none">Invalid Phone number, Aliexpress allow only numbers and hyphens.</span>
                                </div>
                                <div class="row">
                                    <div class="col-sm-offset-2 col-sm-10 m-t-sm">
                                    <label for="" class="control-label">
                                        <input type="radio" id="order_default_phone" name="order_default_phone"
                                        value="seller" class="icheck"
                                        {% if config.order_default_phone != 'customer' %}checked="checked"{% endif %}>
                                        Override customer’s phone number
                                        {% include 'partial/help_tooltip.html' with help="Override the customer’s phone number with the given <b>Order Phone Number</b>" qtipstyle="color:#BBB" %}
                                    </label>
                                    </div>
                                    <div class="col-sm-offset-2 col-sm-10">
                                    <label for="" class="control-label" style="text-align:left">
                                        <input type="radio" id="order_default_phone" name="order_default_phone"
                                        value="customer" class="icheck"
                                        {% if config.order_default_phone == 'customer' %}checked="checked"{% endif %} >
                                        Use the Customer’s Phone Number if present
                                        {% include 'partial/help_tooltip.html' with help="Use the Customer’s Phone Number if present. Only use the <b>Order Phone Number</b> if Customer Phone Number isn’t present." qtipstyle="color:#BBB" %}
                                    </label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row m-t-sm">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="order_custom_note" class="col-sm-2 control-label" style="padding-top:0">
                                            Custom Note To The Supplier
                                    </label>
                                    <div class="col-sm-10">
                                        <input type="text" class="form-control col-sm-2" {% if can_use %}id="order_custom_note" name="order_custom_note" value="{{config.order_custom_note}}"{% endif %}>
                                    </div>
                                    <span class="help-block"></span>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="epacket_shipping" class="col-sm-4 col-xs-8 control-label">Select ePacket when available</label>
                                    <div class="col-sm-6 col-xs-4">
                                        <input type="checkbox" class="js-switch" id="epacket_shipping"
                                               name="epacket_shipping" {% if config.epacket_shipping %}checked="checked"{% endif %}>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="auto_ordered_mark" class="col-sm-4 col-xs-8 control-label">
                                        Automatically Mark as Ordered
                                        {% include 'partial/help_tooltip.html' with help="After you click on <b>'Place Order'</b> button, the order will be marked as Ordered and linked with Aliexpress Order ID." qtipstyle="color:#BBB" %}
                                    </label>
                                    <div class="col-sm-6 col-xs-4">
                                        <input type="checkbox" class="js-switch" id="auto_ordered_mark"
                                               name="auto_ordered_mark" {% if config.auto_ordered_mark == None or config.auto_ordered_mark %}checked="checked"{% endif %}>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="auto_shopify_fulfill" class="col-sm-4 control-label">
                                        Automatically Fulfill
                                        {% include 'partial/help_tooltip.html' with help="Tracked Orders will be fulfilled in Shopify if the Application detect a tracking number." qtipstyle="color:#BBB" %}
                                    </label>
                                    <div class="col-sm-3">
                                        <select id="auto_shopify_fulfill" name="auto_shopify_fulfill" class="form-control">
                                            <option value="disable" {% if not config.auto_shopify_fulfill or config.auto_shopify_fulfill == 'disable' %}selected="selected"{% endif %}>Disable</option>
                                            <option value="enable" {% if config.auto_shopify_fulfill == 'enable' or config.auto_shopify_fulfill == 'hourly' or config.auto_shopify_fulfill == 'daily' %}selected="selected"{% endif %}>Enable</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group shiping-confirmation">
                                    <label for="send_shipping_confirmation" class="col-sm-4 control-label">
                                        Send Shipping Confirmation
                                        {% include 'partial/help_tooltip.html' with help="Select <b>Auto</b> to notify the customer if all items in his order have been shipped." qtipstyle="color:#BBB" %}
                                    </label>
                                    <div class="col-sm-3">
                                        <select id="send_shipping_confirmation" name="send_shipping_confirmation" class="form-control">
                                            <option value="default" {% if not config.send_shipping_confirmation or config.send_shipping_confirmation == 'default' %}selected="selected"{% endif %}>Auto</option>
                                            <option value="yes" {% if config.send_shipping_confirmation == 'yes' %}selected="selected"{% endif %}>Always</option>
                                            <option value="no" {% if config.send_shipping_confirmation == 'no' %}selected="selected"{% endif %}>Never</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group shiping-confirmation">
                                    <label for="validate_tracking_number" class="col-sm-4 col-xs-8 control-label">
                                        Only when Tracking Number is valid
                                        {% include 'partial/help_tooltip.html' with help="Send Confirmation Email only if the tracking number is valid (can be tracked using AfterShip or USPS)" qtipstyle="color:#BBB" %}
                                    </label>
                                    <div class="col-sm-6 col-xs-4">
                                        <input type="checkbox" class="js-switch" id="validate_tracking_number" name="validate_tracking_number"
                                        {% if config.validate_tracking_number or 'validate_tracking_number' not in config %}
                                            checked="checked"
                                        {% endif %}>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="shipping_method_filter" class="col-sm-4 col-xs-8 control-label">
                                        Shipment Method Filter
                                    </label>
                                    <div class="col-sm-6 col-xs-4">
                                        <input
                                            id="shipping_method_filter"
                                            name="shipping_method_filter"
                                            type="checkbox"
                                            class="js-switch" {% if config.shipping_method_filter %}checked disabled{% endif %}
                                        />
                                    </div>
                                </div>
                            </div>
                        </div>

                        {% endwith %}
                        {% endif %}

                        {% if not user.is_superuser %}
                        {% if user|can:'aliexpress_affiliate.use' and not user|can:'admitad_affiliate.use' %}
                        <div class="setting-section">
                            <h3 class="setting-title">Aliexpress Affiliate Program</h3>
                        </div>
                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="aliexpress_affiliate_key" class="col-sm-2 control-label">API Key</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control col-sm-2" id="aliexpress_affiliate_key" name="aliexpress_affiliate_key" value="{{config.aliexpress_affiliate_key}}">
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="aliexpress_affiliate_tracking" class="col-sm-2 control-label">Tracking ID</label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control col-sm-2" id="aliexpress_affiliate_tracking" name="aliexpress_affiliate_tracking" value="{{config.aliexpress_affiliate_tracking}}">
                                    </div>
                                </div>
                            </div>
                        </div>

                        {% elif user|can:'admitad_affiliate.use' %}
                        <div class="setting-section">
                            <h3 class="setting-title">Admitad Affiliate Program</h3>
                        </div>
                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="admitad_site_id" class="col-sm-2 control-label">
                                        Site ID or Deeplink {% include 'partial/help_tooltip.html' with help="<a href='https://help.admitad.com/en/topic/118-what-is-deeplink/' target='_blank'>How to find my Deeplink?</a>" qtipstyle="color:#BBB" %}
                                    </label>
                                    <div class="col-sm-4">
                                        <input type="text" class="form-control col-sm-2" id="admitad_site_id" name="admitad_site_id" value="{{config.admitad_site_id}}">
                                    </div>
                                </div>
                            </div>
                        </div>
                        {% endif %}
                        {% endif %}

                        {% if user|can:'price_change_options.use' %}
                        <div class="setting-section">
                            <h3 class="setting-title">Alerts</h3>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-5">
                                <div class="form-group">
                                    <label for="alert_price_change" class="col-sm-6 control-label">When the price changes</label>
                                    <div class="col-sm-4">
                                        <select id="alert_price_change" name="alert_price_change" class="form-control">
                                            <option value="notify" {% if config.alert_price_change == 'notify' %} selected="selected"{% endif %}>Notify me</option>
                                            <option value="update" {% if config.alert_price_change == 'update' %} selected="selected"{% endif %}>Update with the same margin</option>
                                            <option value="update_for_increase" {% if config.alert_price_change == 'update_for_increase' %} selected="selected"{% endif %}>Update only when price goes up</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-5">
                                <div class="form-group">
                                    <label for="alert_quantity_change" class="col-sm-6 control-label">When inventory changes</label>
                                    <div class="col-sm-4">
                                        <select id="alert_quantity_change" name="alert_quantity_change" class="form-control">
                                            <option value="notify"{% if config.alert_quantity_change == 'notify' %} selected="selected"{% endif %}>Notify me</option>
                                            <option value="update"{% if config.alert_quantity_change == 'update' %} selected="selected"{% endif %}>Update automatically</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-5">
                                <div class="form-group">
                                    <label for="alert_product_disappears" class="col-sm-6 control-label">When a product disappears</label>
                                    <div class="col-sm-4">
                                        <select id="alert_product_disappears" name="alert_product_disappears" class="form-control">
                                            <option value="notify"{% if config.alert_product_disappears == 'notify' %} selected="selected"{% endif %}>Notify me</option>
                                            <option value="unpublish"{% if config.alert_product_disappears == 'unpublish' %} selected="selected"{% endif %}>Unpublish product</option>
                                            <option value="zero_quantity"{% if config.alert_product_disappears == 'zero_quantity' %} selected="selected"{% endif %}>Set the quantity to zero</option>
                                        </select>
                                    </div>
                                </div>
                            </div>

                            <div class="col-sm-5">
                                <div class="form-group">
                                    <label for="alert_variant_disappears" class="col-sm-6 control-label">When a variant disappears</label>
                                    <div class="col-sm-4">
                                        <select id="alert_variant_disappears" name="alert_variant_disappears" class="form-control">
                                            <option value="notify"{% if config.alert_variant_disappears == 'notify' %} selected="selected"{% endif %}>Notify me</option>
                                            <option value="remove"{% if config.alert_variant_disappears == 'remove' %} selected="selected"{% endif %}>Remove the variant</option>
                                            <option value="zero_quantity"{% if config.alert_variant_disappears == 'zero_quantity' %} selected="selected"{% endif %}>Set the quantity to zero</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        {% endif %}

                        {% if user|can:'aliexpress_captcha.use' %}

                        <div class="setting-section">
                            <h3 class="setting-title">Aliexpress Captcha</h3>
                        </div>

                        <div class="row">
                            <div class="col-sm-offset-1 col-sm-11">
                                <div class="form-group">
                                    <label for="aliexpress_captcha" class="col-sm-4 col-xs-8 control-label">
                                        Enable Auto Captcha Solving
                                    </label>
                                    <div class="col-sm-6 col-xs-4">
                                        <input id="aliexpress_captcha" name="aliexpress_captcha" type="checkbox"
                                               class="js-switch" {% if config.aliexpress_captcha %}checked{% endif %} />
                                    </div>
                                </div>
                            </div>
                        </div>

                        {% endif %}

                        {% if user|can:'clippingmagic.use' and not user.is_stripe_customer %}
                            <div class="setting-section" style="float: left;width: 98%;">
                                <h3 class="setting-title">
                                    Clippingmagic API
                                    {% if user.clippingmagic.downloaded_images %}
                                    <span class="pull-right" style="font-size: 12px">
                                        <strong>Note:</strong>
                                        You have consumed {{user.clippingmagic.downloaded_images}} credits
                                    </span>
                                    {% endif %}
                                </h3>
                            </div>
                            <div id="tab-6" class="tab-pane">
                                <div class="panel-body">
                                    <div class="row">
                                        <div class="col-sm-offset-1 col-sm-11">
                                            <div class="form-group">
                                                <div class="form-group">
                                                    <label class="col-sm-3 control-label">ClippingMagic API ID</label>
                                                    <div class="col-sm-6">
                                                        <input type="text" name="api_id"
                                                        value="{{ user.clippingmagic.api_id|default:"" }}"
                                                        class="form-control api_id">
                                                    </div>
                                                </div>
                                                <div class="form-group">
                                                    <label class="col-sm-3 control-label">ClippingMagic API Key</label>
                                                    <div class="col-sm-6" style="white-space: nowrap;">
                                                        <input type="password" name="api_secret"
                                                               value="{{ user.clippingmagic.api_secret|default:"" }}"
                                                               class="form-control api_key"
                                                               style="font-size: .8em; display: inline-block; margin-right: 10px;">

                                                        <a class="show-clippingmagic-key-btn" href="#">Show</a>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endif %}

                        <div class="col-md-12"><hr /></div>
                        <div class="form-group">
                            <div class="col-sm-offset-1 col-sm-10">
                                <button data-toggle="modal" class="btn btn-primary"><i class="fa fa-save"></i> Save</button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
    {% endif %}
<div id="modal-add-store-form" class="modal fade" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-6 b-r"><h3 class="m-t-none m-b">Add Shopify Store</h3>

                        <form role="form">
                            <div class="form-group">
                                <label>Name</label> <input type="text" id="store-name" placeholder="Store Name (optional)" class="form-control"></div>
                            <div class="form-group"><label>API URL</label> <input type="text" id="store-url" placeholder="Copy/Past Example URL" class="form-control"></div>
                            <div>
                                <button id="add-store" class="btn btn-sm btn-primary pull-right m-t-n-xs" type="button"><strong>Add store</strong></button>
                                <button id="update-store" style="display:none" class="btn btn-sm btn-primary pull-right m-t-n-xs" type="button"><strong>Update store</strong></button>
                            </div>
                        </form>
                    </div>
                    <div class="col-sm-6"><h4>Need Help?</h4>
                <p class="xwell">
                    How To Connect Your Shopify Store:
                    <ol>
                        <li>Create a "Shopify Private App"</li>
                        <li>Give a Friendly Store Name and paste the <b>Example URL</b> from your Private App.</li>
                    </ol>

                    <a href="http://www.shopifiedapp.com/start#page-block-voz06qvsbuaqbyb9" target="_blank">Watch Video Instructions</a>
                </p>
                </div>
            </div>
        </div>
        </div>
    </div>
</div>

<div id="product-template-modal" class="modal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="m-t-none modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Description Template</h4>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                        <form role="form" action="" method="post" id="add-template-form">
                            <input type="hidden" name="id" value="">
                            <div class="form-group">
                                <label>Title</label> 
                                <input type="text" name="title" placeholder="Template title" class="form-control">
                            </div>
                            <div class="form-group">
                                <label>Description</label>
                                <textarea name="description" placeholder="Description for template" class="form-control" autocomplete="off"></textarea>
                            </div>
                            <div class="m-t-n-xs">
                                <button type="submit" class="btn btn-sm btn-primary pull-right">Save</button>
                                <button type="button" data-dismiss="modal" class="btn btn-sm btn-default pull-left">Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<div id="product-templates-list-modal" class="modal" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="m-t-none modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Product Custom Descriptions</h4>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                        <table class="table table-ligthborder" id="description-template-table">
                            <thead>
                                <tr>
                                    <th style="vertical-align: middle; min-width: 100px;">Title</th>
                                    <th style="width: 150px;"></th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr data-template-id="" class="hidden clone template-row">
                                    <td class="template-title"></td>
                                    <td>
                                        <a href="#" class="edit-template" title="Edit" style="padding: 8px;" data-id="" data-toggle="modal" data-target="#product-template-modal">
                                            <i class="fa fa-edit"></i>
                                        </a>
                                        <a href="#" class="delete-template" data-id="" data-toggle="tooltip" data-placement="top" title="Delete" style="padding: 8px;">
                                            <i class="fa fa-remove"></i>
                                        </a>
                                    </td>
                                </tr>
                                {% for template in templates %}
                                <tr data-template-id="{{ template.id }}" class="template-row">
                                    <td class="template-title">{{ template.title }}</td>
                                    <td class="no-wrap">
                                        <a href="#" class="edit-template" title="Edit" style="padding: 8px;" data-id="{{ template.id }}" data-toggle="modal" data-target="#product-template-modal">
                                            <i class="fa fa-edit"></i>
                                        </a>
                                        <a href="#" class="delete-template" data-id="{{ template.id }}" data-toggle="tooltip" data-placement="top" title="Delete" style="padding: 8px;">
                                            <i class="fa fa-remove"></i>
                                        </a>
                                    </td>
                                </tr>
                                {% endfor %}
                            </tbody>
                        </table>

                        <a data-toggle="modal" data-target="#product-template-modal" class="btn btn-success btn-sm" style="margin: 0;">
                            <i class="fa fa-plus"></i> Add New Template
                        </a>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-outline btn-default pull-left" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>

<div id="modal-install-form" class="modal fade" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="m-t-none modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Add Shopify Store</h4>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                        <form id="install-store-form" role="form">
                            <div class="form-group">
                                <label for="shop-url">Enter your store's URL:</label>
                                <input type="text" id="shop-url" placeholder="your-shop-url.myshopify.com"
                                       class="form-control" autocorrect="off" spellcheck="false">
                            </div>
                            <p><em>Note: You don't need to create a Private App any more!</em></p>
                        </form>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-outline btn-default pull-left" data-dismiss="modal">Cancel</button>
                <button id="install-store" class="btn btn-primary" type="button"><strong>Add store</strong></button>
            </div>
        </div>
    </div>
</div>

<div id="modal-store-tracking-url" class="modal fade" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="m-t-none modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title">Custom Tracking URL</h4>
            </div>

            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                        <form role="form">
                            <div class="form-group">
                                <label for="shop-url">Enter your custom tracking URL:</label>
                                <input type="text" id="custom-tracking-url-input" class="form-control" autocorrect="off" spellcheck="false">
                            </div>

                            <p>
                                <em>Exmaples:</em>

                                {% verbatim %}
                                <em><a href="#" class="tracking-url-example"
                                       data-url="http://track.aftership.com/{{tracking_number}}">Aftership</a>,</em>

                                <em><a href="#" class="tracking-url-example"
                                       data-url="http://17track.net/?nums={{tracking_number}}">17Track</a>,</em>

                                <em><a href="#" class="tracking-url-example"
                                       data-url="http://global.cainiao.com/detail.htm?mailNoList={{tracking_number}}">Cainiao</a>,</em>

                                <em><a href="#" class="tracking-url-example"
                                       data-url="https://tools.usps.com/go/TrackConfirmAction.action?tLabels={{tracking_number}}">USPS</a></em>
                                {% endverbatim %}
                            </p>

                            <p>
                            <em>Keep the input field empty to use the default tracking url</em>
                            </p>
                        </form>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-outline btn-default pull-left" data-dismiss="modal"><i class="fa fa-times"></i> Cancel</button>
                <button id="save-custom-tracking-btn" class="btn btn-primary" type="button"><i class="fa fa-save"></i> Save</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extracss %}
{% compress css %}
    <link href="{% static 'libs/bower_components/switchery/dist/switchery.min.css' %}" rel="stylesheet">
    <link href="{% static 'libs/bower_components/dragula.js/dist/dragula.min.css' %}" rel="stylesheet">
{% endcompress %}

<style type="text/css">
    label {
        text-align: left !important;
    }
    .setting-section {
        margin-top: 15px;
        border-left: 2px #eee solid;
        padding-top: 5px;
        margin-left: 20px;
        margin-bottom: 15px;
        padding-bottom: 5px;
        background-color: rgb(250, 250, 250);
        padding-left: 15px;
    }
    h3.setting-title {
        padding: 0;
        margin: 5px 0;
    }
    .table-ligthborder {
        border:1px solid #eee;
    }
    .table-ligthborder > thead > tr > th {
        background-color: #fafafa;
    }

    table .label {
        border-radius: 3px !important;
        background-color: #f7f7f8 !important;
        color: #564c4c !important;
        font-size: 12px !important;
        line-height: 1.5 !important;
        font-weight: 500 !important;
    }
    table .label:hover {
        background-color: #dbdbdb !important;
    }
    table .label .num {
        font-weight: 600 !important;
    }
    table td:first-child {
        width: 100%;
    }
    .table > tbody > tr > td {
        vertical-align: middle;
    }
    .table > tbody > tr > td > .btn {
        margin-bottom: 0;
    }
</style>
{% endblock %}

{% block extrajs %}

    <script src="//cdnjs.cloudflare.com/ajax/libs/ckeditor/4.5.4/ckeditor.js"></script>

{% compress js %}
    <script src="{% static 'libs/bower_components/switchery/dist/switchery.min.js' %}"></script>
    <script src="{% static 'libs/bower_components/dragula.js/dist/dragula.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'shopified/js/index.js' %}"></script>
{% endcompress %}

{% if first_visit %}
<script type="text/javascript">
    $(function() {
        var tour = new Tour({
            name: 'tour-intro',
            steps: [{
                element: '.add-store-btn',
                title: 'Step One: Connect your store',
                content: 'The first thing you’ll need to do is connect your Shopify Store to Shopified App.' + '<br />' +
                        'If you don’t have a Shopify store yet, get your <a href="http://bit.ly/sashopifyspecial">21 day free trial with 10% off Shopify for Life</a>.' + '<br />' +
                        'To connect your store, watch the videos on the <a href="http://www.shopifiedapp.com/start">Getting Started</a> page.'
            }, {
                element: '.extension-link',
                title: 'Step Two: Chrome Extension',
                content: 'Install the Shopified App Chrome Extension to start importing products to your stores.',
                placement: 'left',
            }, {
                element: '.profile-options',
                title: 'Your Profile',
                content: 'Edit your email, password and other settings here.',
            }, {
                element: '.current-plan',
                title: 'Plan & Bundles',
                content: 'Click here to view your current Plan and Feature Bundles',
                placement: 'bottom',
            }, ]
        });
        tour.init();
        tour.start();
    });

</script>
{% endif %}

{% endblock %}
