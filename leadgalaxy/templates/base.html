{% load static %}
{% load hijack_tags %}
{% load perms_helper %}
{% load compress %}
{% load cache %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="shortcut icon"  href="{% static 'favicon.png' %}">
    <link rel="icon" href="{% static 'favicon.png' %}" >

    <title>{% block title %}Shopified App{% endblock %}</title>

    <style name="FontAwesome">
        @font-face {
          font-family: 'FontAwesome';
          src: url('{% static "font-awesome/fonts/fontawesome-webfont.eot?v=4.6.3" %}');
          src: url('{% static "font-awesome/fonts/fontawesome-webfont.eot?#iefix&v=4.6.3" %}') format('embedded-opentype'),
               url('{% static "font-awesome/fonts/fontawesome-webfont.woff2?v=4.6.3" %}') format('woff2'),
               url('{% static "font-awesome/fonts/fontawesome-webfont.woff?v=4.6.3" %}') format('woff'),
               url('{% static "font-awesome/fonts/fontawesome-webfont.ttf?v=4.6.3" %}') format('truetype'),
               url('{% static "font-awesome/fonts/fontawesome-webfont.svg?v=4.6.3#fontawesomeregular" %}') format('svg');
          font-weight: normal;
          font-style: normal;
        }
    </style>

    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,400i,700,700i|Roboto+Slab:400,700" rel="stylesheet">

    <link href="{% static 'font-awesome/css/font-awesome.css' %}" rel="stylesheet">
    <link href="//fast.appcues.com/widget.css" rel="stylesheet">

    {% compress css %}
    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/plugins/toastr/toastr.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/plugins/chosen/chosen.css' %}" rel="stylesheet">
    <link href="{% static 'css/animate.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    <link href="{% static 'css/trix.css' %}" rel="stylesheet">
    <link href="{% static 'libs/iCheck/skins/square/blue.css' %}" rel="stylesheet">
    <link href="{% static 'libs/sweetalert/sweetalert.min.css' %}" rel="stylesheet">
    <link href="{% static 'libs/jquery-contextmenu/jquery.contextMenu.min.css' %}" rel="stylesheet">
    <link href="{% static 'libs/bower_components/qtip2/jquery.qtip.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/bootstrap-tour.min.css' %}" rel="stylesheet">
    <link href="{% static 'css/extra.css' %}" rel="stylesheet">
    {% endcompress %}

    {% block extracss %}{% endblock %}

    {% include "partial/custom_tags.html" %}

  </head>
  <body class="fixed-sidebar">
    {% for event in analytic_events %}
        {{ event.fire|safe }}
    {% endfor %}

    <div id="wrapper">
    {{ request|hijackNotification }}

    {% if tos_update and not user.is_subuser %}
        <div class="tos-update">
            Shopified App has updated our Terms of Service.
            You can view them by clicking the link in the Shopified App footer or by
            <a href="/pages/terms-of-service" target="_blank">clicking here</a>.

            <a href="#" type="button" class="close-btn" data-dismiss="alert">×</a>
        </div>
    {% endif %}

    {% block main-nav %}
    <nav class="navbar-default navbar-static-side" role="navigation">
        <div class="sidebar-collapse">
            <ul class="nav metismenu" id="side-menu">
                <li class="profile-element" style="padding:12px 5px 11px 5px;text-align:center;">
                    <img src="{% static 'Shopified-App-White.png' %}" width="160" height="37" />
                </li>

                {% if user.is_authenticated %}
                <li class="nav-header">
                    <div class="dropdown profile-element">
                            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="clear"> <span class="block m-t-xs"> <strong class="font-bold">{{user.get_full_name|default:user.username}}</strong>
                             </span> <span class="text-muted text-xs block profile-options">Options <b class="caret"></b></span> </span> </a>
                            <ul class="dropdown-menu m-t-xs">
                                {% if user.is_superuser %}
                                <li><a href="{% url 'admin:index' %}">Admin Panel</a></li>
                                <li class="divider"></li>
                                {% endif %}

                                {% if user.is_authenticated %}
                                <li><a href="{% url 'user_profile' %}" class="user-profile">Profile</a></li>
                                <li><a href="{% url 'leadgalaxy.views.logout' %}">Logout</a></li>
                                {% endif %}
                            </ul>
                    </div>
                    <div style="font-size: 0.9em;padding: 0;margin: 0;" class="logo-element">
                        <img src="{% static 'logo-element.png' %}" style="width: 50%; ">
                    </div>
                </li>
                {% endif %}

                <li {% if page == 'index' %}class="active"{% endif %}>
                    <a href="{% url 'index' %}">
                        <i class="fa fa-th-large"></i>
                        <span class="nav-label">Stores</span>
                    </a>
                </li>

                {#  #}
                <li {% if page == 'product' or page == 'bulk' or page == 'boards' %}class="active"{% endif %}>
                    <a href="{% url 'product' %}">
                        <i class="fa fa-shopping-cart"></i>
                        <span class="nav-label">Products</span>
                        <span class="fa arrow"></span>
                    </a>

                    <ul class="nav nav-second-level {% if page != 'product' and page != 'bulk' and page != 'boards' %}collapse{% endif %}">
                        <li {% if page == 'product' %}class="active"{% endif %}>
                            <a href="{% url 'product' %}">
                                <i class="fa fa-list"></i>
                                <span class="nav-label">All Products</span>
                            </a>
                        </li>

                        {% if user|can:'view_product_boards.sub' %}
                        <li {% if page == 'boards' %}class="active"{% endif %}>
                            <a href="{% url 'boards_list' %}">
                                <i class="fa fa-edit"></i>
                                <span class="nav-label">Boards</span>
                            </a>
                        </li>
                        {% endif %}

                        {% if request.user|can:'bulk_editing.view' %}
                        <li {% if page == 'bulk' %}class="active"{% endif %}>
                            <a href="{% url 'bulk_edit' what='saved' %}">
                                <i class="fa fa-table"></i>
                                <span class="nav-label">Bulk edit</span>
                            </a>
                        </li>
                        {% endif %}
                    </ul>
                </li>
                {# {% else %} #}
                {# <li> #}
                    {# <a href="{% url 'product' %}"> #}
                        {# <i class="fa fa-shopping-cart"></i> #}
                        {# <span class="nav-label">Products</span> #}
                        {# <span class="fa arrow"></span> #}
                    {# </a> #}
                {# </li> #}
                {# {% endif %} #}

                {% if request.user|can:'orders.view' %}
                <li {% if page == 'orders' %}class="active"{% endif %}>
                    <a href="{% url 'orders' %}" class="">
                        <i class="fa fa-calendar-check-o"></i>
                        <span class="nav-label">Orders</span>
                    </a>
                </li>
                {% endif %}
                {% if request.user|can:'orders.view' or request.user.is_vendor %}
                <li {% if page == 'order_exports' %}class="active"{% endif %}>
                    <a href="{% url 'order_exports_index' %}" class="">
                        <i class="fa fa-file-pdf-o"></i>
                        <span class="nav-label">Order Exports</span>
                    </a>
                </li>
                {% endif %}
                {% if request.user|can:'orders.view' %}
                <li {% if page == 'orders_track' %}class="active"{% endif %}>
                    <a href="{% url 'orders_track' %}" class="">
                        <i class="fa fa-truck"></i>
                        <span class="nav-label">Tracking</span>
                    </a>
                </li>
                {% endif %}

                {% if request.user|can:'price_changes.use' %}
                <li {% if page == 'product_alerts' %}class="active"{% endif %}>
                    <a href="{% url 'product_alerts' %}">
                        <i class="fa fa-bell"></i>
                        <span class="nav-label">Alerts</span>
                        {% cache 1800 alert_info user.id %}
                        {% with user.profile.get_new_alerts as alerts %}
                            {% if alerts %}
                            <span class="label label-info pull-right">{{alerts}}</span>
                            {% endif %}
                        {% endwith %}
                        {% endcache %}
                    </a>
                </li>
                {% endif %}

                {% if user|can:'product_feeds.use' %}
                <li {% if page == 'product_feeds' %}class="active"{% endif %}>
                    <a href="#">
                        <i class="fa fa-bar-chart"></i>
                        <span class="nav-label">Marketing</span>
                        <span class="fa arrow"></span>
                    </a>
                    <ul class="nav nav-second-level collapse">
                        <li><a  {% if page == 'product_feeds' %}class="active"{% endif %}
                                href="{% url 'product_feeds' %}"
                            >Product Feeds</a></li>
                    </ul>
                </li>
                {% endif %}

                {% if request.user.is_superuser %}
                <li {% if 'acp' in page %}class="active"{% endif %}>
                    <a href="#">
                        <i class="fa fa-cogs"></i>
                        <span class="nav-label">Admin</span>
                        <span class="fa arrow"></span>
                    </a>
                    <ul class="nav nav-second-level collapse">
                        <li {% if page == 'acp_users_list' %}class="active"{% endif %}>
                            <a href="{% url 'acp_users_list' %}">Users
                            <span class="label label-info pull-right"
                                  onclick="javascript:setTimeout(function(){var q=prompt('Query Shopified App Users');if(q.length) {window.location.href='/acp/users/list?q='+q;}},10);return false;">Search</span>
                            </a>
                        </li>
                        <li {% if page == 'acp_groups' %}class="active"{% endif %}><a href="{% url 'acp_groups' %}">Plans</a></li>
                        <li {% if page == 'acp_graph' %}class="active"{% endif %}><a href="{% url 'acp_graph' %}">Analytics</a></li>
                        <li {% if page == 'acp_pages' %}class="active"{% endif %}><a href="/pages/">Pages</a></li>
                        <li><a href="/admin/article/sidebarlink/">Sidebar Links</a></li>
                        <li><a href="/admin/leadgalaxy/featurebundle/">Bundles</a></li>
                    </ul>
                </li>
                {% elif user|can:'leadgalaxy.add_planregistration' %}
                    <li {% if 'acp' in page %}class="active"{% endif %}>
                    <a href="#">
                        <i class="fa fa-cogs"></i>
                        <span class="nav-label">Admin</span>
                        <span class="fa arrow"></span>
                    </a>
                    <ul class="nav nav-second-level collapse">
                        <li {% if page == 'acp_groups' %}class="active"{% endif %}><a href="{% url 'acp_groups' %}">Plans &amp; Groups</a></li>
                    </ul>
                </li>
                {% endif %}

                {% if user|can:'sub_users.use' and not user.is_subuser %}
                <li {% if page == 'subusers' %}class="active"{% endif %}>
                    <a href="{% url 'subusers' %}">
                        <i class="fa fa-users"></i>
                        <span class="nav-label">Sub Users</span>
                    </a>
                </li>
                {% endif %}

                {% cache 1800 sidebar_link user.id user.profile.plan_id %}
                {% include 'partial/sidebar_link.html' with links=sidebar_links plan=user.profile.plan.register_hash %}
                {% endcache %}
            </ul>

        </div>
    </nav>
    {% endblock %}

   <div id="page-wrapper" class="gray-bg">
        <div class="row border-bottom page-search-nav">
            <nav class="navbar navbar-static-top white-bg" role="navigation" style="margin-bottom: 0">
                <div class="navbar-header">
                    <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>
                    <form role="search" class="navbar-form-custom" method="get"
                        {% if searchable %}
                            action="{{request.path}}"
                        {% else %}
                            action="/product"
                        {% endif %}
                    >
                        <div class="form-group">
                            <input type="text" placeholder="Search" class="form-control" name="title" id="top-search"
                            {% if request.GET.title and request.GET.f %}
                                   value="{{request.GET.title}}"
                            {% endif %}
                            >
                            <input type="hidden" name="f" value="1">

                            {% if request.GET.store %}
                            <input type="hidden" name="store" value="{{request.GET.store}}">
                            {% endif %}
                        </div>
                    </form>
                </div>
                <ul class="nav navbar-top-links navbar-right">
                    <li>
                        <span class="m-r-sm text-muted welcome-message">
                            {% if request.user.is_authenticated %}
                                {% if request.user.profile.plan.description %}
                                    <a href="/user/profile#plan" class="current-plan itooltip" data-toggle="tooltip" data-placement="bottom" title="" data-original-title="View Your Plans &amp; Bundles" style="font-size: 13px">
                                        {{request.user.profile.plan.description}}
                                    </a>
                                {% endif %}

                                {% if extra_bundle %}
                                    <a class="btn btn-default btn-outline btn-xs" href="{{extra_bundle.url}}"
                                       style="min-height:0;padding:2px 5px;font-size:13px;background-color:#de873d;color:#FFFFFF;border-color:#cc5e00;font-weight:bold;box-shadow: 0px 0px 7px rgba(204, 94, 0, 0.7);"
                                       {% if not extra_bundle.sametab %}target="_blank"{% endif %}
                                       {{extra_bundle.attrs|default:''|safe}}>{{extra_bundle.title}}</a>
                                {% endif %}

                                {% if request.user.profile.plan.badge_image %}
                                    <img style="height: 35px;" src="{{ request.user.profile.plan.badge_image }}" alt=""
                                        {% if 'tooltip' in request.user.profile.plan.badge_image %}
                                        qtip-tooltip="<img style='width: 100%' src='{{ request.user.profile.plan.large_badge_image }}'>"

                                        qtip-my="top right"
                                        qtip-at="bottom left"
                                        {% endif %}
                                    />
                                {% endif %}
                            {% endif %}
                        </span>
                    </li>
                    <li>
                        <div id="notification-bell"></div>
                    </li>
                    <li>
                        {% if user.is_authenticated %}
                        <a href="{% url 'leadgalaxy.views.logout' %}">
                            <i class="fa fa-sign-out"></i> Log out
                        </a>
                        {% else %}
                        <a href="{% url 'django.contrib.auth.views.login' %}">
                            <i class="fa fa-sign-in"></i> Log in
                        </a>
                        {% endif %}
                    </li>
                </ul>

            </nav>
        </div>
        <div class="row wrapper border-bottom white-bg page-heading">
            <div class="col-lg-10">
                <h2>{% block page-title %}{% endblock %}</h2>
                {% if breadcrumbs %}
                <ol class="breadcrumb">
                    {% for item in breadcrumbs %}
                        {% if item.url %}
                        <li><a href="{{item.url}}">{{item.title|safe|truncatewords:10}}</a></li>
                        {% else %}
                        <li class="active"><strong>{{item|safe|truncatewords:10}}</strong></li>
                        {% endif %}
                    {% endfor %}
                </ol>
                {% endif %}
            </div>
            <div class="col-lg-2"></div>
        </div>

      <div class="wrapper wrapper-content">
        {% if messages %}
            {% for message in messages %}
            <div class="alert
                {% if message.tags %}
                    alert-{{ message.tags }}
                    {% if message.tags == 'error' %}
                        alert-danger
                    {% else %}
                        alert-{{ message.tags }}
                    {% endif %}
                {% endif %}
                alert-dismissable">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">×</button>
                {{ message|safe }}
            </div>
            {% endfor %}
        {% endif %}

        {% block main-container %}{% endblock %}
      </div>

        <div class="footer">
            <div class="pull-right" style="margin-right:30px">
                 <span class="extension-version" data-extension-version="{{extension_release}}" style="color:#008c06"
                       {% if extension_required %}data-required="true"{% endif %}></span>
            </div>

            <div>
                Shopified App &copy; {% now "Y" %} -
                <a href="https://app.shopifiedapp.com/pages/terms-of-service" target="_blank">
                    Terms Of Service
                </a>
            </div>
        </div>
    </div>
  </div>

<div id="modal-board-add" class="modal fade" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                        <h3 class="m-t-none m-b">Add new board</h3>
                        <form id="new-board-add-form" role="form">
                            <div class="form-group">
                                <input type="text" id="add-board-name" placeholder="New Board Name" class="form-control">
                            </div>

                            <div>
                                <button id="board-add-send" class="btn btn-sm btn-primary pull-right m-t-n-xs" type="button">
                                    <strong>Add</strong>
                                </button>
                            </div>
                        </form>
                    </div>
            </div>
        </div>
        </div>
    </div>
</div>

    {# Mainly scripts #}
    {% compress js %}
    <script src="{% static 'js/jquery.min.js' %}"></script>
    <script src="{% static 'libs/bower_components/raven-js/dist/raven.min.js' %}"></script>
    {% endcompress %}

    {% block extrajs-before %}{% endblock %}

    {% compress js %}
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/plugins/metisMenu/jquery.metisMenu.js' %}"></script>
    <script src="{% static 'js/plugins/slimscroll/jquery.slimscroll.min.js' %}"></script>
    <script src="{% static 'js/jquery.unveil.js' %}"></script>

    <script src="{% static 'libs/iCheck/icheck.min.js' %}"></script>
    <script src="{% static 'libs/jquery-contextmenu/jquery.contextMenu.min.js' %}"></script>
    <script src="{% static 'libs/jquery-contextmenu/jquery.ui.position.min.js' %}"></script>

    <script src="{% static 'libs/sweetalert/sweetalert.min.js' %}"></script>
    <script src="{% static 'libs/jquery-autocomplete/jquery.autocomplete.min.js' %}"></script>
    <script src="{% static 'libs/bower_components/qtip2/jquery.qtip.min.js' %}"></script>
    <script src="{% static 'js/bootstrap-tour.min.js' %}"></script>
    <script src="{% static 'libs/bower_components/js-cookie/src/js.cookie.js' %}"></script>

    <script src="{% static 'js/inspinia.js' %}"></script>
    <script src="{% static 'js/plugins/pace/pace.min.js' %}"></script>
    <script src="{% static 'js/plugins/toastr/toastr.min.js' %}"></script>
    <script src="{% static 'js/plugins/chosen/chosen.jquery.js' %}" type="text/javascript"></script>
    <script src="{% static 'js/trix.js' %}"></script>
    <script src="{% static 'js/main.js' %}?v=6"></script>
    {% endcompress %}

    {% block extrajs %}{% endblock %}

    <script type="text/javascript" src="https://static.leaddyno.com/js"></script>
    <script>
        if (typeof (LeadDyno) !== 'undefined') {
            LeadDyno.key = "be5d77f4d08a0aa53f3696f40f056889461cf5be";
            LeadDyno.recordVisit();
            LeadDyno.autoWatch();
        }
    </script>
  </body>
</html>
