{% load static %}
{% load hijack_tags %}
{% load perms_helper %}

<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="shortcut icon"  href="/static/favicon.png">
    <link rel="icon" href="/static/favicon.png" >

    <title>{% block title %}Shopified App{% endblock %}</title>

    <link href="{% static 'css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'font-awesome/css/font-awesome.css' %}" rel="stylesheet">

    <link href="{% static 'css/animate.css' %}" rel="stylesheet">
    <link href="{% static 'css/style.css' %}" rel="stylesheet">
    <link href="{% static 'css/trix.css' %}" rel="stylesheet">
    <link href="{% static 'css/extra.css' %}" rel="stylesheet">
    <link href="//cdnjs.cloudflare.com/ajax/libs/iCheck/1.0.1/skins/square/blue.css" rel="stylesheet">
    <link href="//cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.0.0/jquery.contextMenu.min.css" rel="stylesheet">
    <link href="//cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.css" rel="stylesheet">

    <style type="text/css">
    .icheckbox_square-blue {
        position: absolute;
        margin: 5px;
        background-color: #fff;
    }
    </style>
    {% block extracss %}{% endblock %}

  </head>
  <body>
    <div id="wrapper">
    {{ request|hijackNotification }}
    {% block main-nav %}
    <nav class="navbar-default navbar-static-side" role="navigation" style="position: fixed; overflow: auto; top: 0; bottom: 0; ">
        <div class="sidebar-collapse">
            <ul class="nav metismenu" id="side-menu">
                <li>
                    <img src="/static/Shopified-App.png" style="width: 100%; padding: 10px 25px;">
                </li>
                <li class="nav-header">
                    <div class="dropdown profile-element">
                            <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                            <span class="clear"> <span class="block m-t-xs"> <strong class="font-bold">{{user.entity.full_name|default:user.username}}</strong>
                             </span> <span class="text-muted text-xs block">Options <b class="caret"></b></span> </span> </a>
                            <ul class="dropdown-menu animated fadeInRight m-t-xs">
                                {% if user.is_superuser %}
                                <li><a href="{% url 'admin:index' %}">Admin Panel</a></li>
                                {% endif %}

                                {% if user.is_authenticated %}
                                <li><a href="{% url 'leadgalaxy.views.logout' %}">Logout</a></li>
                                {% endif %}
                            </ul>
                    </div>
                    <div style="font-size: 0.9em;padding: 0;margin: 0;" class="logo-element">
                        <img src="http://i.imgur.com/z1kYnEV.png" style="width: 50%; ">
                    </div>
                </li>

                <li {% if page == 'index' %}class="active"{% endif %}><a href="{% url 'index' %}"> <i class="fa fa-th-large"></i> <span class="nav-label">Stores</span></a></li>

                <li {% if page == 'product' %}class="active"{% endif %}><a href="{% url 'product' %}"> <i class="fa fa-shopping-cart"></i> <span class="nav-label">Products</span></a></li>

                <li {% if page == 'bulk' %}class="active"{% endif %}><a href="{% url 'bulk_edit' %}"> <i class="fa fa-table"></i> <span class="nav-label">Bulk edit</span></a> </li>

                <li {% if page == 'boards' %}class="active"{% endif %}>
                    <a href="{% url 'boards' %}">
                        <i class="fa fa-edit"></i>
                        <span class="nav-label">Boards</span>
                        <span class="fa arrow"></span>
                    </a>
                    {% if page == 'boards' %}
                    <ul class="nav nav-second-level collapse in">
                        {% for item in request.user.shopifyboard_set.all %}
                        <li><a href="#b{{item.id}}">{{item.title}}</a></li>
                        {% endfor %}
                        <li><a href="#" class="add-board-btn"><span class="fa fa-plus"></span> Add Board</a></li>
                    </ul>
                    {% endif %}
                </li>

                {% if request.user.is_superuser %}
                <li {% if 'acp' in page %}class="active"{% endif %}>
                    <a href="#">
                        <i class="fa fa-cogs"></i>
                        <span class="nav-label">Admin</span>
                        <span class="fa arrow"></span>
                    </a>
                    <ul class="nav nav-second-level collapse">
                        <li {% if page == 'acp_users_list' %}class="active"{% endif %}><a href="{% url 'acp_users_list' %}">Users</a></li>
                    </ul>
                </li>
                {% endif %}
            </ul>

        </div>
    </nav>
    {% endblock %}

   <div id="page-wrapper" class="gray-bg">
        <div class="row border-bottom">
            <nav class="navbar navbar-static-top white-bg" role="navigation" style="margin-bottom: 0">
                <div class="navbar-header">
                    <a class="navbar-minimalize minimalize-styl-2 btn btn-primary " href="#"><i class="fa fa-bars"></i> </a>
                    <form role="search" class="navbar-form-custom" method="post" action="#">
                        <div class="form-group">
                            <input type="text" placeholder="Search" class="form-control" name="top-search" id="top-search">
                        </div>
                    </form>
                </div>
                <ul class="nav navbar-top-links navbar-right">
                    <li>
                        <span class="m-r-sm text-muted welcome-message">
                            {% if request.user|in_group:'VIP Members' %}
                                <img style="height: 35px;" src="{% static 'img/vip-badge.png' %}" alt="VIP Member">
                            {% endif %}
                        </span>
                    </li>
                    <li>
                        {% if user.is_authenticated %}
                        <a href="{% url 'leadgalaxy.views.logout' %}">
                            <i class="fa fa-sign-out"></i> Log out
                        </a>
                        {% else %}
                        <a href="{% url 'django.contrib.auth.views.login' %}">
                            <i class="fa fa-sign-in"></i> Log in
                        </a>
                        {% endif %}
                        </a>
                    </li>
                </ul>

            </nav>
        </div>
        <div class="row wrapper border-bottom white-bg page-heading">
            <div class="col-lg-10">
                <h2>{% block page-title %}{% endblock %}</h2>
                {% if breadcrumbs %}
                <ol class="breadcrumb">
                    {% for item in breadcrumbs %}
                        {% if item.url %}
                        <li><a href="{{item.url}}">{{item.title}}</a></li>
                        {% else %}
                        <li class="active"><strong>{{item}}</strong></li>
                        {% endif %}
                    {% endfor %}
                </ol>
                {% endif %}
            </div>
            <div class="col-lg-2"></div>
        </div>

      <div class="wrapper wrapper-content animated fadeInRight">
        {% if messages %}
            {% for message in messages %}
            <div class="alert {% if message.tags %} alert-{{ message.tags }} {% endif %} alert-dismissable">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">Ã—</button>
                {{ message }}
            </div>
            {% endfor %}
        {% endif %}

        {% block main-container %}{% endblock %}
      </div>

        <div class="footer">
            <div class="pull-right">
                 <strong></strong>
            </div>
            <div>
                <strong>Copyright</strong> Shopified App &copy; 2015
            </div>
        </div>
    </div>
  </div>

<div id="modal-board-add" class="modal fade" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-body">
                <div class="row">
                    <div class="col-sm-12">
                        <h3 class="m-t-none m-b">Add new board</h3>
                        <form id="new-board-add-form" role="form">
                            <div class="form-group">
                                <input type="text" id="add-board-name" placeholder="New Board Name" class="form-control">
                            </div>

                            <div>
                                <button id="board-add-send" class="btn btn-sm btn-primary pull-right m-t-n-xs" type="button">
                                    <strong>Add</strong>
                                </button>
                            </div>
                        </form>
                    </div>
            </div>
        </div>
        </div>
    </div>
</div>

    <!-- Mainly scripts -->
    <script src="{% static 'js/jquery-2.1.1.js' %}"></script>
    <script src="{% static 'js/bootstrap.min.js' %}"></script>
    <script src="{% static 'js/plugins/metisMenu/jquery.metisMenu.js' %}"></script>
    <script src="{% static 'js/plugins/slimscroll/jquery.slimscroll.min.js' %}"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/iCheck/1.0.1/icheck.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.0.0/jquery.contextMenu.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery-contextmenu/2.0.0/jquery.ui.position.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/sweetalert/1.1.3/sweetalert.min.js"></script>
     <!--<script src="//cdnjs.cloudflare.com/ajax/libs/jqueryui/1.11.4/jquery-ui.js"></script> -->

    <!-- Custom and plugin javascript -->
    <script src="{% static 'js/inspinia.js' %}"></script>
    <script src="{% static 'js/plugins/pace/pace.min.js' %}"></script>
    <script src="{% static 'js/trix.js' %}"></script>
    <script src="{% static 'js/main.js' %}"></script>

    <script type="text/javascript">
        $(function() {
            $('.icheck').iCheck({
                checkboxClass: 'icheckbox_square-blue',
                radioClass: 'iradio_square-blue',
            });

            $(".add-board-btn").click(function(e) {
                e.preventDefault();
                $('#modal-board-add').modal('show');
            });

            var tout = null;
            $('#hijacked-warning').css('top', '-22px');
            $('#hijacked-warning').mouseenter(function (e) {
                $( this ).animate({
                    top: "0",
                }, 500, function() {
                    // Animation complete.
                });
                if (tout) {
                    clearTimeout(tout);
                    tout = null;
                }
            }).mouseleave(function (e) {
                // $(this).css('top', '-22px');
                var el = this;
                tout = setTimeout(function() {
                    $( el ).animate({
                        top: "-22px",
                    }, 500, function() {
                        // Animation complete.
                    });
                }, 1000);
            });

            function createBoard(e) {
                e.preventDefault();

                $.ajax({
                    url: '/api/boards-add',
                    type: 'POST',
                    data: {
                        title: $('#add-board-name').val()
                    },
                    success: function(data) {
                        if ('status' in data && data.status == 'ok') {
                            $('#modal-board-add').modal('hide');
                            if (typeof(window.onBoardAdd) == 'function') {
                                window.onBoardAdd(data.board);
                            } else {
                                window.location.href = window.location.href;
                            }

                            $('#add-board-name').val('');
                        } else {
                            alert('error' in data ? data.error : 'Server error');
                        }
                    },
                    error: function (data) {
                        alert('error' in data ? data.error : 'Server error');
                    }
                })
            };

            $("#new-board-add-form").submit(createBoard);
            $("#board-add-send").click(createBoard);
            $("#board-add-send").keypress(function (e) {
                  if (e.which == 13) {
                    createBoard(e);
                    return false;
                  }
            });
        });
    </script>

    {% block extrajs %}{% endblock %}

  </body>
</html>
