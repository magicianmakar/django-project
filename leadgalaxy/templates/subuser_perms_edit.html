{% extends "base.html" %}

{% load widget_tweaks %}
{% load static %}

{% block extracss %}
    <link href="{% static 'libs/bower_components/switchery/dist/switchery.min.css' %}" rel="stylesheet">
{% endblock %}

{% block extrajs %}
    <script src="{% static 'libs/bower_components/switchery/dist/switchery.min.js' %}"></script>
    <script src="{% static 'shopified/js/subuser_perms_edit.js' %}" type="text/javascript"></script>
{% endblock %}

{% block main-container %}
<div class="row">
    <div class="col-md-12">
        <div class="ibox collapsed border-bottom">
            <div class="ibox-title">
                <h5>General Permissions</h5>
            </div>
            <div class="ibox-content" style="display:block">
                <div class="alert alert-warning alert-dismissible" role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    The general permissions are not related to a specific store and will affect the account no matter what store this user is assigned to.
                </div>
                {% for error in form.permissions.errors %}
                    <p class="text-danger">{{ error }}</p>
                {% endfor %}
                <form
                    method="POST"
                    role="form"
                    action="{% url 'subuser_perms_edit' subuser.id %}"
                >
                    <div class="form-group">
                        {% render_field form.permissions %}
                    </div>
                    <p>
                        <button type="submit" class="btn btn-primary">
                            <i class="fa fa-save"></i> Save
                        </button>
                    </p>
                </form>
            </div>
            <br />
            <div class="ibox-title">
                <h5>Store Permissions</h5>
            </div>
            <div class="ibox-content" style="display:block">
                <div class="alert alert-warning alert-dismissible" role="alert">
                    <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                    Store permissions are assigned on a per store basis. To assign permissions, click Edit next to the store. Make sure to do this for each store. If you do not see the store listed, go back to the previous screen and make sure you have assigned the user to the store.
                </div>
                {% for store in subuser.profile.subuser_stores.all %}
                    <p>
                        {{ store.title }} &nbsp;
                        <a class="btn btn-xs btn-outline btn-success board-btn _pull-right" href="{% url 'subuser_store_permissions' subuser.id store.id %}">Edit</a>
                    </p>
                {% empty %}
                    <p class="text-center">
                        No stores found
                    </p>
                {% endfor %}
            </div>
        </div>
    </div>
</div>
{% endblock main-container %}
