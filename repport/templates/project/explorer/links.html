{% extends "project/base.html" %}
{% load url_tools %}

{% block page-title %}Project Explorer{% endblock %}

{% block project-main-row-size %}col-md-12{% endblock %}

{% block project-main %}
<div class="row">
    <div class="col-lg-12">
        <div class="tabs-container">
            <ul class="nav nav-tabs">
                <li class="active"><a href="/project/explorer/{{project.id}}-links">Internal Links</a></li>
                <li class=""><a href="/project/explorer/{{project.id}}-titles">Page Titles</a></li>
                <li class=""><a href="/project/explorer/{{project.id}}-description">Meta Description</a></li>
                <li class=""><a href="/project/explorer/{{project.id}}-images">Images</a></li>
                <li class=""><a href="/project/explorer/{{project.id}}-h1">H1</a></li>
                <li class=""><a href="/project/explorer/{{project.id}}-h2">H2</a></li>
            </ul>
            <div class="tab-content">
                <div class="tab-pane active" id="tab-1">
                    <div class="panel-body">
                        <table class="table table-bordered dataTables">
                            <thead>
                                <tr>
                                    <th>Link</th>
                                    <th>Title</th>
                                    <th>Status</th>
                                </tr>
                            </thead>
                            <tbody>
                            {% for item in links %}
                                <tr>
                                    <td><a class="show-urls" url-id="{{item.id}}" href="#">{{item.url}}</a></td>
                                    <td>{{item.title}}</td>
                                    <td>{{item.status}}</td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="tab-pane" id="tab-2">
                </div>
            </div>


        </div>
    </div>
</div>

<div style="height: 300px; z-index: 1000;" id="main-panel">
    <iframe src="#" style="width: 100%; height: 100%;"></iframe>
</div>

<button id="main-panel-close" class="btn btn-sm" style="z-index: 10002"><i class="fa fa-times"></i></button>


{% endblock %}

{% block extracss %}
<!-- Data Tables -->
<link href="/static/css/plugins/dataTables/dataTables.bootstrap.css" rel="stylesheet">
<link href="/static/css/plugins/dataTables/dataTables.responsive.css" rel="stylesheet">
<link href="/static/css/plugins/dataTables/dataTables.tableTools.min.css" rel="stylesheet">
{% endblock %}

{% block extrajs %}
    <!-- Data Tables -->
    <script src="/static/js/plugins/dataTables/jquery.dataTables.js"></script>
    <script src="/static/js/plugins/dataTables/dataTables.bootstrap.js"></script>
    <script src="/static/js/plugins/dataTables/dataTables.responsive.js"></script>
    <script src="/static/js/plugins/dataTables/dataTables.tableTools.min.js"></script>

    <script type="text/javascript">
       $(document).ready(function() {
            $('.dataTables').dataTable({
                responsive: true,
                "dom": 'T<"clear">lfrtip',
                "tableTools": {
                    "sSwfPath": "/static/js/plugins/dataTables/swf/copy_csv_xls_pdf.swf"
                }
            });
        });

        setInterval(function () {
            if ($( "#main-panel" ).css('display') != 'none') {
                $( "#main-panel" ).position({
                  my: "right bottom",
                  at: "right-25 bottom",
                  of: window
                });

                $( "#main-panel-close" ).position({
                  my: "right top",
                  at: "right-5 top+5",
                  of: '#main-panel'
                });
            }
        }, 100);

        $( "#main-panel" ).hide();

        $('.show-urls').click(function(e){
            e.preventDefault();

            $( "#main-panel iframe" ).attr('src', '/project/explorer/frame/{{project.id}}-links?link='+$(this).attr('url-id'));
            $( "#main-panel" ).show();
            $( "#main-panel-close" ).show();
        });

        $( "#main-panel-close" ).click(function(e){
            e.preventDefault();

            $('#main-panel').hide();
            $( "#main-panel-close" ).hide();
        });
    </script>
{% endblock %}

